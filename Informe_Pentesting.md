# Informe de Pentesting: ScoutTech Web Application

## Resumen Ejecutivo

El objetivo de esta evaluación fue identificar vulnerabilidades en la aplicación web ScoutTech y proporcionar recomendaciones para solventarlas. Durante el análisis, se detectaron fallos de seguridad como inyecciones SQL, Cross Site Scripting, XSS y el manejo de sesiones y la protección contra CSRF. Estos problemas hacen que un ciberdelincuente comprometa la confidencialidad, integridad y disponibilidad del sistema.

## Metodología

Se utilizó un enfoque de caja gris que incluyó: **reconocimiento**, el análisis de la estructura de la aplicación y funciones críticas, **escaneo de vulnerabilidades**, la identificación de entradas vulnerables, **explotación** y **recomendaciones**.

## Resultados del análisis

### 1. Vulnerabilidades de Inyección SQL

La aplicación es vulnerable a SQLi en múltiples puntos:

- Formulario de inicio de sesión: Permite manipular la consulta SQL al introducir caracteres especiales en el campo de usuario.
- add_comment.php: el parámetro de la id es vulnerable.

#### Impacto

 Acceso no autorizado a cuentas de usuario y manipulación de datos de la base de datos.

#### Pruebas

Explotación del formulario de inicio de sesión mediante Burp Suite para realizar ataques de fuerza bruta.

**Payload**:

```
172.20.0.2/add_comment.php?id=3', 4, 'probando'); --
```

#### Recomendaciones

Utilizar consultas preparadas con marcadores de posición para todas las interacciones con la base da datos y validar y sanear las entradas del usuario con filtros específicos.

### 2. Cross-Site Scripting (XSS)

El campo de comentarios permite la ejecución de script maliciosos.

#### Impacto

Robot de coockies de sesión y ejecución de script maliciosos en el navegador de otros usuarios.

#### Pruebas

Inyección del siguiente payload en el campo del comentario:

```
<script>alert('ALERTA');</script>
```

El script se ejecuta cada vez que el usuario accede a ver los comentarios de los jugadores.

#### Recomendaciones

Implementa la función htmlspecialchars() para sanear las salidas de texto que provienen del usuario y configurar cabeceras de seguridad.

### 3. Control de acceso y manejo de sesiones

Falta de control de acceso en página críticas como `register.php` son accesibles sin autenticación. Además de que el almacenamiento de contraseñas es inseguro porque se guardan en texto plano. También se utiliza una cookie en lugar de variables se sesión seguras.

#### Impacto

Acceso no autorizado como administrador y exposición de contraseñas sensibles.

#### Recomendaciones

Restringir el acceso a páginas críticas verificando el rol y autenticación del usuario mediante variables de sesión. También almacenar las contraseñas utilizando un hash y habilitar el uso de cookies de sesión.

### 4. Vulnerabilidad CSRF (Cross-Site Request Forgery)

La aplicación no implementa protecciones contra ataques CSRF. Un atacante puede engañar a un usuario con enlaces maliciosos.

#### Impacto

Transferencias de dinero no autorizadas y alteración de datos críticos.

#### Pruebas

Ejecución del siguiente enlace malicioso:

```
<a href="http://web.pagos/donate.php?amount=100&receiver=attacker">Donar ahora</a>
```

#### Recomendaciones

Implementar tokens CSRF en formularios y solicitudes críticas y verificar el origen de las solicitudes con cabeceras como `Referer`.

### 5. Configuración del servidor web

El servidor presenta configuración por defecto inseguras:

- Exposición de la firma del servidor.
- Falta de HTTPS.

#### Impacto

Mayor visibilidad para los atacantes sobre las tecnologías utilizadas y riesgo de intercepción de datos sensibles

#### Recomendaciones

Deshabiltiar la firma del servidor, configurar HTTPS utilizando un certificado válido e implementar cabeceras de seguridad.

## Conclusión 

La aplicación ScoutTech presenta vulnerabilidades críticas que podrían ser explotadas para comprometer la seguridad de los usuarios y los datos. La implementación de las recomendaciones propuestas es esencial para mitigar estos riesgos.